<link rel="import" href="elements.html">
<!--
The following custom properties and mixins are available for styling:

Custom property | Description | Default
----------------|-------------|----------
`--socobo-profile-profile-wrapper` | Styling the Main Element Wrapper Container. | `{}`

@demo demo/index.html
-->
<dom-module id="socobo-profile">
  <template>
    <style>
      :host {
        display: block;
        font-family: 'Roboto', 'Helvetica Neue', Helvetica, Arial, sans-serif;
      }
      .profile-wrapper {
        width: 100%;
        height: 900px; /*temp for developing (100%)*/
        @apply(--socobo-profile-profile-wrapper);
      }
    </style>

    <div class="profile-wrapper">
      <socobo-profile-page
        id="profilePage"
        user-login="{{userLogin}}"
        profile-object="{{_profileObject}}"
        on-profile-image-changed="_handleProfileDataChanged"
        on-profile-user-info-changed="_handleProfileUserInfoChanged"
        on-account-deleted="_handleAccountDeleted">
      </socobo-profile-page>
    </div>
  </template>

  <script>
    (function() {
      Polymer({
        is: 'socobo-profile',
        /**
         * Element Properties.
         */
        properties: {
          /**
           * User Login Object
           */
          userLogin: {
            type: Object,
            value: {},
            notify: true
          }
        },

        /**
         * User Profile Object
         * @private
         */
        _profileObject: {},

        /**
         * PRIVATE FUNCTIONS
         */
        /**
         *
         * @param e CustomEvent
         * @private
         * @method _handleProfileDataChanged
         */
        _handleProfileDataChanged: function(e) {
          var profileImage = e.detail;
          this.fire("profile-image-changed", profileImage);
        },

        /**
         *
         * @param e CustomEvent
         * @private
         * @method _handleProfileUserInfoChanged
         */
        _handleProfileUserInfoChanged: function(e) {
          var tmp = e.detail;
          this.fire("profile-user-info-changed", tmp);
        },

        /**
         *
         * @param e CustomEvent
         * @private
         * @method _handleAccountDeleted
         */
        _handleAccountDeleted: function(e) {
          this.fire("account-deleted");
        },

        /**
         * PUBLIC FUNCTIONS
         */
        /**
         * Load User Profile Data from Firebase
         * @method loadProfileData
         */
        loadData: function() {
          SocoboProfile
            .getInstance(this.userLogin.firebaseUrl, this.userLogin.userId)
            .loadProfileData()
            .then(function(data){
              this._profileObject = data;
              this.fire("profile-data-changed", data);
            }.bind(this))
            .catch(function(err){
              console.dir(err);
            });
        }
      });
    })();
  </script>
</dom-module>
